# BH_ED

[![Build Status](https://github.com/WeiMXi/BH_ED.jl/workflows/CI/badge.svg)](https://github.com/WeiMXi/BH_ED.jl/actions)
[![Coverage](https://codecov.io/gh/WeiMXi/BH_ED.jl/branch/master/graph/badge.svg)](https://codecov.io/gh/WeiMXi/BH_ED.jl)

It's a Julia program for repetition of some work in [Exact diagonalization: Bose–Hubbard model | stone-zeng.github.io](https://stone-zeng.github.io/2019-10-03-exact-diagonalization/)



But our work is a bit different with the reference.

Done by Dr. Ning and me.

Our Hamiltonion formula:

![](./equation.svg)

## For start, just

```Julia
]add https://github.com/WeiMXi/BH_ED.jl
using BH_ED
```

### Get the solver

```julia
julia> sol = BH_solver()
N: 4 with Lp: 2
We got all required states.
Dimension of Hilbert space: 81
We get Hamiltonion Matrix.
Number of nonzero elements: 568 (8.657%) of total.
Hamiltonion Matrix is a Real Symmetric Matrix.
Ground energy is -6.170948273483543
Then We will return the eigenvalue and the corresponding eigenvector
([-6.170948273483543, -6.061357609582469], [[1.821076769005032e-15, 0.11001728713984608, 0.1100172871398469, 0.13240502310254088, 0.13240502310250984, 1.1069202281597654e-14, 1.4022503384188303e-15, -3.4434675068894942e-15, 7.920173936602456e-15, 9.715590987987506e-15  …  -6.25075454903631e-15, 8.725547361135275e-16, 4.61482157495106e-16, -2.7351212146447475e-15, -5.8420445832143515e-15, 0.007434513513864009, 0.007434513513865063, 0.007397697924279043, 0.007397697924278869, -9.755030165016445e-16], [0.09581237239108663, -9.677838436488839e-15, -1.1315364436015222e-14, -2.716247117826712e-14, 1.7887314392391346e-14, 0.20532721080340594, 0.25641057910695336, 0.20532721080342714, 0.24319986616745892, 0.25641057910694154  …  0.026738345150477495, 0.027831882684026605, 0.02148027644458768, 0.02673834515047231, 0.021480276444596522, -5.398351946704109e-15, -7.049391433156871e-15, -4.754589551111733e-15, -4.2555191577311425e-15, 0.0023312444981999753]], ConvergenceInfo: 2 converged values after 2 iterations and 42 applications of the linear map;
norms of residuals are given by (5.447757292048336e-13, 7.775519817025229e-13).
)

julia> sol[1] # the eigenvaluse
2-element Vector{Float64}:
 -6.170948273483543
 -6.061357609582469

julia> sol[2]   #  the corresponding eigenvectors
2-element Vector{Vector{Float64}}:
 [1.821076769005032e-15, 0.11001728713984608, 0.1100172871398469, 0.13240502310254088, 0.13240502310250984, 1.1069202281597654e-14, 1.4022503384188303e-15, -3.4434675068894942e-15, 7.920173936602456e-15, 9.715590987987506e-15  …  -6.25075454903631e-15, 8.725547361135275e-16, 4.61482157495106e-16, -2.7351212146447475e-15, -5.8420445832143515e-15, 0.007434513513864009, 0.007434513513865063, 0.007397697924279043, 0.007397697924278869, -9.755030165016445e-16]
 [0.09581237239108663, -9.677838436488839e-15, -1.1315364436015222e-14, -2.716247117826712e-14, 1.7887314392391346e-14, 0.20532721080340594, 0.25641057910695336, 0.20532721080342714, 0.24319986616745892, 0.25641057910694154  …  0.026738345150477495, 0.027831882684026605, 0.02148027644458768, 0.02673834515047231, 0.021480276444596522, -5.398351946704109e-15, -7.049391433156871e-15, -4.754589551111733e-15, -4.2555191577311425e-15, 0.0023312444981999753]
```

### Get the Hamiltonion Matrix

```julia
julia> them = give_a_BH_Model(N = 6, Lp = 3)
BH_ED.BH_Model(["000000", "000001", "000010", "000100", "001000", "010000", "100000", "000002", "000011", "000020"  …  "333313", "333322", "333331", "233333", "323333", "332333", "333233", "333323", "333332", "333333"], 6, 18, 3, 1.0, 1.0, 1.0, 1.0

julia> theh = give_H(them)
4096×4096 SparseArrays.SparseMatrixCSC{Float64, Int64} with 56263 stored entries:
⣿⣿⣛⠶⢶⣦⣀⢀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⢻⡜⠻⣦⣄⠈⠙⠳⠿⣤⡀⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠸⣷⡀⠙⠿⣧⣀⡀⠀⠈⠛⠾⣷⣀⠀⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⢘⢷⡀⠀⠸⣿⣿⣄⠀⠀⠀⠀⠻⣶⣙⢦⡀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠈⠛⣧⡀⠀⠀⠙⠻⣦⣦⡀⠀⠀⠀⠉⠓⣦⠰⣄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⢬⣻⡄⠀⠀⠈⠻⣿⣿⣆⠀⠀⠀⠀⠘⢿⣬⠳⠄⠀⠀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠙⢻⣤⡀⠀⠀⠈⠙⢻⣶⣦⡀⠀⠀⠀⠉⠛⣆⢦⡀⠀⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠠⣜⢻⡄⠀⠀⠀⠈⠻⣿⣿⣦⡀⠀⠀⠀⠘⣧⡝⠂⠀⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠈⠳⠹⣤⣀⠀⠀⠀⠈⠻⠿⣧⣄⡀⠀⠀⠈⠛⣧⣄⠀⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠐⢦⡛⣷⡄⠀⠀⠀⠀⠹⣿⣿⣦⡀⠀⠀⠘⣯⡓⠀⠀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠆⠻⢤⣀⠀⠀⠀⠈⠻⠻⣦⣄⠀⠀⠈⢻⣤⡀⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠳⣍⠿⣦⠀⠀⠀⠀⠙⣿⣿⡆⠀⠈⢷⡅⠀
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠉⢿⡶⣤⡀⠀⠈⠉⢻⣶⣄⠈⢿⡆
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠙⠈⠛⣶⢦⣄⡀⠙⠻⣦⡜⣧
⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠁⠉⠻⠷⠶⣭⣿⣿

```

## Help
```
?BH_soler
?give_a_BH_Model
?give_give_H
```
